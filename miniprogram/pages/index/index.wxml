<!--index.wxml-->
<wxs src="./index.wxs" module="format" />

<view id="header" class="body body-scale">
  <button 
      open-type="getUserInfo" 
      bindgetuserinfo="onGetUserInfo"
      class="userinfo-avatar"
      style="background-image: url({{avatarUrl}})">
  </button>
  <view class="section">
    <picker mode="date" fields="month" bindchange="bindDateChange">
      <view class="picker">
        {{date}}
      </view>
    </picker>
    <i class="arrow"></i>
  </view>
  <day-select year="{{selectedYear}}" 
              month="{{selectedMonth}}" 
              day="{{currentDay}}" 
              tags="{{hasAccount}}" 
              bindselectedDay="_selectedDay"/>
</view>

<view style="background: white; margin: {{bodyHeight + 10}}px 0 0 0;">
  <view id="chart" class="chart"> 
    <ec-canvas id="month-chart" canvas-id="mychart-line" ec="{{ ec }}"></ec-canvas>
  </view>
</view>
<view class='card'>
  <view class='left'>
    <count-up class="income" startVal="0" endVal="{{income}}" decimals="2" duration="1"></count-up>
  </view>
  <view class="right">
    <count-up class="expend" startVal="0" endVal="{{expenses}}" decimals="2" duration="1"></count-up>
  </view>
</view>

<view class="detail-list">
  <text class="title">当日明细</text>
  <ul>
    <li wx:key="{{item.key}}" class="{{item.val.type > 0 ? 'income-item' : 'expenses-item'}}" wx:for="{{details}}">
      <view class="detail-left">
        <text class="detail-title">{{item.val.name}}</text>
        <text class="detail-sub">{{item.val.type > 0 ? '收入': '支出'}}</text>
      </view>
      <view class="amount {{item.val.type > 0 ? 'income-color' : 'expenses-color'}}">
        {{item.val.type > 0 ? '+' : '-'}}{{format.toMoney(item.val.amount)}}
      </view>
    </li>
  </ul>
</view>

<footer class="footer" bindtap="navToAccountInput">
  <text> 添加账目 </text> 
</footer>